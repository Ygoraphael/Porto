package fme;

import java.util.Vector;
import javax.swing.JScrollPane;
import javax.swing.JTable;






































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































class CBTabela_IndicIDT
  extends CBTabela
{
  Frame_Indic P;
  
  public String getPagina()
  {
    return "Indic";
  }
  
  CBTabela_IndicIDT()
  {
    tag = "IndicadoresIDT";
    P = ((Frame_Indic)fmeApp.Paginas.getPage("Indic"));
    if (P == null) return;
    started = true;
    
    cols = new CHTabColModel[6];
    cols[0] = new CHTabColModel("indicador", "Indicador (Id)", true, false, false, null);
    cols[1] = new CHTabColModel("indicador_d", "Indicador", true, false, true, null);
    cols[2] = new CHTabColModel("val_p2", "Ano -2", true, true, true, CFLib.VLD_VALOR_0);
    cols[3] = new CHTabColModel("val_p1", "Ano -1", true, true, true, CFLib.VLD_VALOR_0);
    cols[4] = new CHTabColModel("val_0", "Ano 0", true, true, true, CFLib.VLD_VALOR_0);
    cols[5] = new CHTabColModel("val_fim_proj", "No Ano de Conclusão<br>do Projeto", true, true, true, CFLib.VLD_VALOR_0);
    
    init_dados(1);
    

    init_handler(P.getJTable_IndicIDT());
    P.getJTable_IndicIDT().addKeyListener(new TableKeyListener(this));
    handler.width = (P.getJScrollPane_IndicIDT().getWidth() - 2);
    
    handler.set_col_text(1, 0.32D, null);
    handler.set_col_text(2, 0.16D, "R");
    handler.set_col_text(3, 0.16D, "R");
    handler.set_col_text(4, 0.16D, "R");
    handler.set_col_text(5, 0.2D, "R");
    
    keyCol = 0;
    
    ((String[])dados.elementAt(0))[0] = "51";
    ((String[])dados.elementAt(0))[1] = "Total das despesas de I&D";
    
    CBData.Params.bind_ano_cand_update(this);
  }
  
  public void on_external_update(String tag)
  {
    if (!started) return;
    if (tag.equals("ano_cand")) {
      int ano = (int)CBData.Params.getByName("ano_cand").valueAsDouble();
      cols[2].col_name = Integer.toString(ano - 2);
      cols[3].col_name = Integer.toString(ano - 1);
      cols[4].col_name = Integer.toString(ano);
      handler.repaint_col_names();
    }
  }
  
  CHValid_Grp validar(CHValid_Grp err_list)
  {
    if (err_list == null) {
      err_list = new CHValid_Grp(this, "Indicadores de I&DT");
    }
    




    StringBuffer mask = new StringBuffer("-----R");
    int ano_cand = (int)CBData.Params.getByName("ano_cand").valueAsDouble();
    int ano_inicial = ano_cand;
    String v = PromotorgetByName"dt_inicio_act"v;
    if (v.length() == 10) ano_inicial = Integer.parseInt(v.substring(0, 4));
    if (ano_cand - ano_inicial >= 2) mask.setCharAt(getColIndex("val_p2"), 'R');
    if (ano_cand - ano_inicial >= 1) mask.setCharAt(getColIndex("val_p1"), 'R');
    if (ano_cand - ano_inicial >= 0) { mask.setCharAt(getColIndex("val_0"), 'R');
    }
    for (int i = 0; i < dados.size(); i++) {
      TabError[] e = isIncompletAll(i, mask.toString());
      for (int ii = 0; (e != null) && (ii < e.length); ii++) {
        err_list.add_msg(new CHValid_Msg("incomplet", e[ii].msg("Linha %L incompleta: %T - %o")));
      }
    }
    return err_list;
  }
}
