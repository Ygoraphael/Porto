package fme;

import java.util.Vector;
import javax.swing.JComboBox;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextArea;
import javax.swing.table.JTableHeader;




































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































class CBTabela_BensServProj
  extends CBTabela
{
  Frame_Mercados P;
  JComboBox cbo_areas;
  
  public String getPagina()
  {
    return "Mercados";
  }
  



  int detalhe = -1;
  int limite = 1000;
  
  CBTabela_BensServProj() {
    P = ((Frame_Mercados)fmeApp.Paginas.getPage("Mercados"));
    if (P == null) return;
    initialize();
  }
  
  void initialize() {
    tag = "BensServProj";
    started = true;
    force_xml = true;
    
    cols = new CHTabColModel[5];
    cols[0] = new CHTabColModel("n_ordem", "Nº", true, false, true, null);
    cols[1] = new CHTabColModel("design", "Bem / Serviço", true, true, true, null);
    cols[2] = new CHTabColModel("perc_vol_neg_pre", "% Vol. Negócios - Pré-Projeto", true, true, true, CFLib.VLD_PERC);
    cols[3] = new CHTabColModel("perc_vol_neg_pos", "% Vol. Negócios - Pós-Projeto", true, true, true, CFLib.VLD_PERC);
    cols[4] = new CHTabColModel("texto", "Texto", true, false, false, null);
    
    init_dados(7);
    

    init_handler(P.jTable_BensServProj);
    P.jTable_BensServProj.addKeyListener(new TableKeyListener(this));
    handler.width = P.jScrollPane_BensServProj.getWidth();
    
    ui = new GroupableTableHeaderUI();
    ui.setH(2, P.jTable_BensServProj);
    
    ui.add_col(0, 0, 1, 2, "Nº");
    ui.add_col(1, 0, 1, 2, "Bem / Serviço");
    ui.add_col(2, 0, 2, 1, "% Vol. Negócios");
    ui.add_col(2, 1, 1, 1, "Pré-Projeto");
    ui.add_col(3, 1, 1, 1, "Pós-Projeto");
    
    P.jTable_BensServProj.getTableHeader().setUI(ui);
    
    handler.set_col_text(0, 0.06D, "C");
    handler.set_col_text(1, 0.6D, null);
    handler.set_col_text(2, 0.15D, "R");
    handler.set_col_text(3, 0.15D, "R");
    
    set_detalhe();
  }
  
  void on_update(String colname, int nRow, String v) {
    numerar(0);
    
    handler.j.repaint();
    if ((!CBData.reading_xml) && (!CBData.clear_pg)) {
      after_update();
    }
  }
  
  public void set_detalhe() {
    int nRow = P.jTable_BensServProj.getSelectedRow();
    if ((nRow >= 0) && (nRow < P.jTable_BensServProj.getRowCount()) && (getColValue("n_ordem", nRow).length() > 0)) {
      P.setDescricao_BensServProj(getColValue("n_ordem", nRow) + " - " + getColValue("design", nRow));
    } else {
      P.setDescricao_BensServProj("");
    }
  }
  
  public void after_update() {
    set_detalhe();
    
    handler.j.repaint();
  }
  

  void on_current_row() { on_row(P.jTable_BensServProj.getSelectedRow()); }
  
  void on_row(int nRow) {
    if (nRow != detalhe) altera_detalhe(nRow);
    CBData.DadosBensServProj.on_update2();
  }
  
  void altera_detalhe(int nRow) { if ((nRow >= 0) && (nRow < P.jTable_BensServProj.getRowCount())) {
      P.getjTextArea_BensServProj_Txt().setText(getColValue("texto", nRow));
    } else {
      P.getjTextArea_BensServProj_Txt().setText("");
    }
    detalhe = nRow;
    after_update();
  }
  
  public boolean on_ins_row() {
    altera_detalhe(-1);
    if (super.on_ins_row()) {
      on_current_row();
      return true;
    }
    return false;
  }
  
  public boolean on_add_row() {
    altera_detalhe(-1);
    if (super.on_add_row()) {
      on_current_row();
      return true;
    }
    return false;
  }
  
  public boolean on_del_row() {
    altera_detalhe(-1);
    if (super.on_del_row()) {
      on_current_row();
      return true;
    }
    return false;
  }
  
  CHValid_Grp validar(CHValid_Grp err_list) {
    if (err_list == null) {
      err_list = new CHValid_Grp(this, "Análise Bens / Serviços objeto do Projeto");
    }
    if (isEmpty()) {
      err_list.add_msg(new CHValid_Msg("indicador", "%o"));
    }
    for (int j = 0; j < dados.size(); j++) {
      String mask = "RRRRR";
      TabError[] e = isIncompletAll(j, mask.toString());
      for (int ii = 0; (e != null) && (ii < e.length); ii++) {
        err_list.add_msg(new CHValid_Msg("incomplet", e[ii].msg("Linha %L incompleta: %T - %o")));
      }
    }
    return err_list;
  }
}
