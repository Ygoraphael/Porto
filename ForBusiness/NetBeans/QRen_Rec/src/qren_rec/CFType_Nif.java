package fme;

import java.text.DecimalFormat;
import javax.swing.JOptionPane;


















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































class CFType_Nif
  extends CFTypeNumber
{
  CFType_Nif()
  {
    FMT = new DecimalFormat("#########");
  }
  
  boolean setText(String _t, boolean interact) {
    v = null;
    if (_t.length() == 0) {
      return true;
    }
    String erro = "NIF inv√°lido.";
    
    String e = _t.substring(0, 1);
    














    boolean ok = super.setText(_t, interact);
    if (!ok) {
      return ok;
    }
    
    if ((_t.length() != 9) || (_t.equals("123456789"))) {
      ok = false;
    }
    if (!ok) {
      if (interact) {
        JOptionPane.showMessageDialog(null, erro, "Erro", 
          0);
      }
      return ok;
    }
    
    ok = _lib.is_digitsOnly(_t);
    if (!ok) {
      if (interact) {
        JOptionPane.showMessageDialog(null, erro, "Erro", 
          0);
      }
      return ok;
    }
    
    if (e.equals("T")) {
      return true;
    }
    
    String[] array = {
      "1", "2", "5", "6", "7", "8", "9" };
    ok = false;
    for (int i = 0; i < array.length; i++) {
      if (e.equals(array[i])) {
        ok = true;
      }
    }
    if (!ok) {
      if (interact) {
        JOptionPane.showMessageDialog(null, erro, "Erro", 
          0);
      }
      return ok;
    }
    
    long cdg = 0L;
    Character zero = new Character('0');
    
    for (int i = 0; i < 8; i++) {
      e = _t.substring(i, i + 1);
      char[] d = e.toCharArray();
      Character a = new Character(d[0]);
      cdg += (a.charValue() - zero.charValue()) * (i + 2);
    }
    cdg %= 11L;
    Character ultimo; if (cdg == 10L) {
      Character ultimo = zero;
      cdg = 0L;
    }
    else {
      char[] asciiChar = { (char)(int)(zero.charValue() + cdg) };
      ultimo = new Character(asciiChar[0]);
    }
    if (!ultimo.toString().equals(_t.substring(8, 9))) {
      if (interact) {
        JOptionPane.showMessageDialog(null, erro, "Erro", 
          0);
      }
      return false;
    }
    return true;
  }
}
