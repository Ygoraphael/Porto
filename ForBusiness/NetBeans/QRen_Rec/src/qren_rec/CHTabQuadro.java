package fme;

import java.util.Vector;





























































































































































































































































































































































































































































































































































































































































































































































































































































































































class CHTabQuadro
  extends CHTabela
{
  CFType[] row_vld;
  boolean[] row_editable;
  String[] row_autocalc;
  
  CHTabQuadro() {}
  
  void start_rows()
  {
    int n = d.dados.size();
    row_vld = new CFType[n];
    row_editable = new boolean[n];
    row_autocalc = new String[n];
    for (int i = 0; i < n; i++) {
      row_vld[i] = null;
      row_editable[i] = true;
      row_autocalc[i] = null;
    }
  }
  


  public void setValueAt(Object v, int i, int j)
  {
    String s = (String)v;
    j = cdx[j];
    CFType col_vld = d.cols[j].vld;
    boolean ok = true;
    if (s.length() == 0) {
      ((String[])d.dados.elementAt(i))[j] = s;


    }
    else if (row_vld[i] != null)
    {
      ok = row_vld[i].setText(s);
      if (ok) {
        ((String[])d.dados.elementAt(i))[j] = row_vld[i].getString();
      }
      
    }
    else if (col_vld != null) {
      ok = col_vld.setText(s);
      if (ok) {
        ((String[])d.dados.elementAt(i))[j] = col_vld.getString();
      }
    } else {
      ((String[])d.dados.elementAt(i))[j] = s;
    }
    CBData.setDirty();
    d.on_update(d.cols[j].col_tag, i, s);
  }
  
  public Object getValueAt(int i, int j)
  {
    j = cdx[j];
    CFType col_vld = d.cols[j].vld;
    String s = ((String[])d.dados.elementAt(i))[j];
    

    if ((d.cols[j].editable) && (row_vld[i] != null)) {
      row_vld[i].setString(s);
      s = row_vld[i].getText();

    }
    else if (col_vld != null) {
      col_vld.setString(s);
      s = col_vld.getText();
    }
    return s;
  }
  
  public boolean isCellEditable(int i, int j) {
    j = cdx[j];
    return (row_editable[i] != 0) && (d.cols[j].editable);
  }
  
  public boolean isRowEditable(int i) {
    return row_editable[i];
  }
  
  public boolean isColEditable(int j) {
    j = cdx[j];
    return d.cols[j].editable;
  }
  
  public boolean valOnline(Object v, int i, int j)
  {
    j = cdx[j];
    CFType vld = d.cols[j].vld;
    String s = (String)v;
    


    boolean ok = true;
    if (s.length() == 0) {
      return true;
    }
    
    if (row_vld[i] != null)
    {
      ok = row_vld[i].setText(s);
      return ok;
    }
    if (vld != null)
    {
      ok = vld.setText(s);
      return ok;
    }
    return true;
  }
}
